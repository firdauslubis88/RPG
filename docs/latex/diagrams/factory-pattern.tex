\documentclass[tikz,border=10pt]{standalone}
\usepackage{tikz}
\usetikzlibrary{shapes,arrows,positioning,fit,backgrounds}

\begin{document}

\tikzstyle{interface} = [rectangle, draw, fill=yellow!20, text width=6em, text centered, rounded corners, minimum height=3em]
\tikzstyle{class} = [rectangle, draw, fill=blue!20, text width=6em, text centered, minimum height=3em]
\tikzstyle{arrow} = [thick,->,>=stealth]
\tikzstyle{implement} = [thick,dashed,->,>=stealth]

\begin{tikzpicture}[node distance=2.5cm, auto]

% Title
\node [above] at (0,5.5) {\Large\textbf{Factory Method Pattern}};
\node [above] at (0,5) {\textit{Week 10 - Branch 10-02}};

% ObstacleFactory interface
\node [interface] (factory) at (0,3) {
    \texttt{<<interface>>}\\
    \textbf{ObstacleFactory}\\
    \rule{4em}{0.4pt}\\
    \texttt{+createObstacle()}
};

% Concrete factories
\node [class, below left=of factory, xshift=-3cm] (spike) {
    \textbf{SpikeFactory}\\
    \rule{4em}{0.4pt}\\
    \texttt{+createObstacle()}\\
    \texttt{return new Spike()}
};

\node [class, below=of factory] (goblin) {
    \textbf{GoblinFactory}\\
    \rule{4em}{0.4pt}\\
    \texttt{+createObstacle()}\\
    \texttt{return new Goblin()}
};

\node [class, below right=of factory, xshift=3cm] (wolf) {
    \textbf{WolfFactory}\\
    \rule{4em}{0.4pt}\\
    \texttt{+createObstacle()}\\
    \texttt{return new Wolf()}
};

% Obstacle interface
\node [interface, right=of factory, xshift=4cm] (obstacle) {
    \texttt{<<interface>>}\\
    \textbf{Obstacle}\\
    \rule{4em}{0.4pt}\\
    \texttt{+update(delta)}\\
    \texttt{+getDamage()}\\
    \texttt{+getSymbol()}
};

% Concrete obstacles
\node [class, below left=of obstacle, xshift=-1.5cm, yshift=-0.5cm] (spikeobj) {
    \textbf{Spike}\\
    \rule{4em}{0.4pt}\\
    \texttt{-damage: 10}\\
    \texttt{-symbol: '\^{}'}
};

\node [class, below=of obstacle, yshift=-0.5cm] (goblinobj) {
    \textbf{Goblin}\\
    \rule{4em}{0.4pt}\\
    \texttt{-damage: 20}\\
    \texttt{-symbol: 'G'}
};

\node [class, below right=of obstacle, xshift=1.5cm, yshift=-0.5cm] (wolfobj) {
    \textbf{Wolf}\\
    \rule{4em}{0.4pt}\\
    \texttt{-damage: 25}\\
    \texttt{-symbol: 'W'}
};

% WorldController (client)
\node [class, above=of factory, yshift=1cm] (controller) {
    \textbf{WorldController}\\
    \rule{4em}{0.4pt}\\
    \texttt{-factories: List}\\
    \rule{4em}{0.4pt}\\
    \texttt{+spawn()}
};

% Arrows - implements
\draw [implement] (spike) -- (factory);
\draw [implement] (goblin) -- (factory);
\draw [implement] (wolf) -- (factory);

\draw [implement] (spikeobj) -- (obstacle);
\draw [implement] (goblinobj) -- (obstacle);
\draw [implement] (wolfobj) -- (obstacle);

% Arrows - creates
\draw [arrow, red, thick] (spike) -- (spikeobj) node[midway, above, sloped] {\textcolor{red}{\texttt{creates}}};
\draw [arrow, red, thick] (goblin) -- (goblinobj) node[midway, above, sloped] {\textcolor{red}{\texttt{creates}}};
\draw [arrow, red, thick] (wolf) -- (wolfobj) node[midway, above, sloped] {\textcolor{red}{\texttt{creates}}};

% Arrows - uses
\draw [arrow] (controller) -- (factory) node[midway, left] {\texttt{uses}};
\draw [arrow] (controller.east) -- ++(1,0) |- (obstacle.west) node[near end, above] {\texttt{uses}};

% Factory returns Obstacle
\draw [arrow, blue, thick] (factory.east) -- (obstacle.west) node[midway, above] {\textcolor{blue}{\texttt{returns}}};

% Annotations
\node [draw, fill=green!10, text width=10em, below=of goblin, yshift=-3cm] (note1) {
    \textbf{Key Benefits:}\\
    \begin{itemize}
        \item Loose coupling
        \item Open/Closed Principle
        \item Easy to extend
        \item No switch statements
    \end{itemize}
};

\node [draw, fill=orange!10, text width=10em, right=of note1, xshift=2cm] (note2) {
    \textbf{Add New Type:}\\
    1. Create DragonFactory\\
    2. Add to factories list\\
    3. Done! No modification\\
    to existing code.
};

\end{tikzpicture}

\end{document}
