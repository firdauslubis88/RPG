% Game Loop Pattern Flow Diagram
% Compile: pdflatex game-loop-pattern.tex

\documentclass[tikz,border=10pt]{standalone}
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage{amssymb}
\usepackage{newunicodechar}
\usepackage{tikz}
\usetikzlibrary{positioning,shapes,arrows,calc}

% Define Unicode characters
\newunicodechar{✓}{\checkmark}
\newunicodechar{•}{$\bullet$}

\begin{document}

\begin{tikzpicture}[
    process/.style={rectangle, draw=black, thick, minimum width=3cm, minimum height=1cm, align=center, rounded corners},
    decision/.style={diamond, draw=black, thick, minimum width=2cm, minimum height=2cm, align=center, aspect=2},
    start/.style={circle, draw=black, thick, minimum size=1cm, fill=green!20},
    arrow/.style={->,>=stealth,thick},
    label/.style={font=\small}
]
    % Start
    \node[start] (start) {Start};

    % Initialize
    \node[process, fill=blue!10, below=1cm of start] (init) {Initialize};

    % Main loop decision
    \node[decision, fill=yellow!20, below=1.5cm of init] (running) {running?};

    % Calculate delta
    \node[process, fill=cyan!10, below=1.5cm of running] (delta) {
        Calculate $\Delta t$ \\
        \scriptsize delta = currentTime - lastTime
    };

    % Update
    \node[process, fill=green!20, below=1cm of delta] (update) {
        \textbf{update($\Delta t$)} \\[2pt]
        \scriptsize Logic only \\
        \scriptsize No rendering!
    };

    % Draw
    \node[process, fill=orange!20, below=1cm of update] (draw) {
        \textbf{draw()} \\[2pt]
        \scriptsize Rendering only \\
        \scriptsize No logic!
    };

    % Sync
    \node[process, fill=purple!20, below=1cm of draw] (sync) {
        \textbf{sync()} \\[2pt]
        \scriptsize Control FPS \\
        \scriptsize Target: 60 FPS
    };

    % End
    \node[start, fill=red!20, right=4cm of running] (end) {End};

    % Arrows
    \draw[arrow] (start) -- (init);
    \draw[arrow] (init) -- (running);
    \draw[arrow] (running) -- node[left,label] {true} (delta);
    \draw[arrow] (running) -- node[above,label] {false} (end);
    \draw[arrow] (delta) -- (update);
    \draw[arrow] (update) -- (draw);
    \draw[arrow] (draw) -- (sync);

    % Loop back
    \draw[arrow] (sync) -- ++(3,0) |- (running);

    % Annotations
    \node[right=0.5cm of update, align=left, font=\scriptsize] (ann-update) {
        • Move entities \\
        • Check collisions \\
        • Update game state \\
        • Frame-independent!
    };

    \node[right=0.5cm of draw, align=left, font=\scriptsize] (ann-draw) {
        • Clear screen \\
        • Draw entities \\
        • Render HUD \\
        • Fast \& efficient!
    };

    % Key benefit
    \node[below=2cm of sync, fill=green!10, draw, thick, rounded corners, inner sep=10pt, align=center] (benefit) {
        \textbf{Key Benefits:} \\[4pt]
        ✓ Testable (update() without display) \\
        ✓ Frame-rate independent (delta time) \\
        ✓ Predictable performance (60 FPS) \\
        ✓ Clean separation of concerns
    };

\end{tikzpicture}

\end{document}
