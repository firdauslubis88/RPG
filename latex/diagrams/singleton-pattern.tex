% Singleton Pattern Structure Diagram
% Compile: pdflatex singleton-pattern.tex

\documentclass[tikz,border=10pt]{standalone}
\usepackage{tikz}
\usetikzlibrary{positioning,shapes,arrows,fit}

\begin{document}

\begin{tikzpicture}[
    class/.style={rectangle, draw=black, thick, minimum width=4cm, minimum height=3cm, align=left},
    code/.style={font=\ttfamily\scriptsize},
    label/.style={font=\bfseries},
    annotation/.style={font=\small,align=center},
    arrow/.style={->,>=stealth,thick}
]
    % Main class box
    \node[class, fill=blue!10] (singleton) at (0,0) {
        \hspace{0.2cm}\textbf{GameManager} \\[4pt]
        \hspace{0.2cm}\rule{3.5cm}{0.4pt} \\[2pt]
        \hspace{0.2cm}\textcolor{red}{- instance: GameManager} \\
        \hspace{0.2cm}- score: int \\
        \hspace{0.2cm}- gameTime: float \\[2pt]
        \hspace{0.2cm}\rule{3.5cm}{0.4pt} \\[2pt]
        \hspace{0.2cm}\textcolor{red}{- GameManager()} \\
        \hspace{0.2cm}\textcolor{blue}{+ getInstance(): GameManager} \\
        \hspace{0.2cm}+ addScore(int): void \\
        \hspace{0.2cm}+ getScore(): int
    };

    % Annotations
    \node[annotation, text=red, above right=0.2cm and 0.3cm of singleton.north east, anchor=west] (ann1) {
        \textbf{1. Static instance} \\
        Holds THE single instance
    };

    \node[annotation, text=red, below right=1.2cm and 0.3cm of singleton.east, anchor=west] (ann2) {
        \textbf{2. Private constructor} \\
        Prevents: new GameManager()
    };

    \node[annotation, text=blue, below right=0.2cm and 0.3cm of singleton.south east, anchor=west] (ann3) {
        \textbf{3. Public getInstance()} \\
        Global access point
    };

    % Arrows pointing to annotations
    \draw[arrow,red,dashed] (singleton.north east) -- (ann1.west);
    \draw[arrow,red,dashed] (singleton.east) -- (ann2.west);
    \draw[arrow,blue,dashed] (singleton.south east) -- (ann3.west);

    % Code example below
    \node[below=2cm of singleton, code, align=left, fill=yellow!10, draw, rounded corners, inner sep=8pt] (code) {
        \textcolor{blue}{public class} GameManager \{ \\
        \hspace{0.5cm}\textcolor{red}{private static} GameManager instance = \textcolor{red}{null}; \\
        \\
        \hspace{0.5cm}\textcolor{red}{private} GameManager() \{ /* ... */ \} \\
        \\
        \hspace{0.5cm}\textcolor{blue}{public static} GameManager getInstance() \{ \\
        \hspace{1cm}\textcolor{blue}{if} (instance == \textcolor{red}{null}) \{ \\
        \hspace{1.5cm}instance = \textcolor{blue}{new} GameManager(); \\
        \hspace{1cm}\} \\
        \hspace{1cm}\textcolor{blue}{return} instance; \\
        \hspace{0.5cm}\} \\
        \}
    };

    \node[above=0.3cm of code, label] {Implementation:};

    % Usage example
    \node[right=1.5cm of code, code, align=left, fill=green!10, draw, rounded corners, inner sep=8pt] (usage) {
        \textcolor{gray}{// ❌ Compiler error!} \\
        GameManager m = \textcolor{blue}{new} GameManager(); \\
        \\
        \textcolor{gray}{// ✅ Correct way:} \\
        GameManager mgr = GameManager.getInstance(); \\
        mgr.addScore(10);
    };

    \node[above=0.3cm of usage, label] {Usage:};

\end{tikzpicture}

\end{document}
